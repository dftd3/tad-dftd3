# This file is part of tad-dftd3.
# SPDX-Identifier: Apache-2.0
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""
Collection of test samples.
"""
from typing import Dict

import torch
from tad_mctc.data.molecules import merge_nested_dicts, mols
from tad_mctc.typing import Molecule, Tensor, TypedDict


class Refs(TypedDict):
    """
    Format of reference values. Note that energies and gradients are calculated
    with different parameters.
    """

    cn: Tensor
    """Coordination number."""

    weights: Tensor
    """Weights for atomic reference systems."""

    c6: Tensor
    """C6 coefficients."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values."""


refs: Dict[str, Refs] = {
    "LiH": Refs(
        {
            "cn": torch.tensor([], dtype=torch.double),
            "weights": torch.tensor([], dtype=torch.double),
            "c6": torch.tensor([], dtype=torch.double),
        }
    ),
    "SiH4": Refs(
        {
            "cn": torch.tensor(
                [
                    +3.89022710629348e00,
                    +9.72651698030399e-01,
                    +9.72651698030399e-01,
                    +9.72651698030399e-01,
                    +9.72651698030399e-01,
                ],
                dtype=torch.double,
            ),
            "weights": torch.tensor(
                [
                    [
                        +5.00040274964878e-27,
                        +9.51882822683413e-16,
                        +2.54542759053980e-07,
                        +2.64839020628269e-02,
                        +9.73515843394413e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.77454000458529e-01,
                        +2.25459995414711e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.77454000458529e-01,
                        +2.25459995414711e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.77454000458529e-01,
                        +2.25459995414711e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.77454000458529e-01,
                        +2.25459995414711e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
            "c6": torch.tensor(
                [
                    [
                        +1.51435152661277e02,
                        +2.13999949401839e01,
                        +2.13999949401839e01,
                        +2.13999949401839e01,
                        +2.13999949401839e01,
                    ],
                    [
                        +2.13999949401839e01,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                    ],
                    [
                        +2.13999949401839e01,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                    ],
                    [
                        +2.13999949401839e01,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                    ],
                    [
                        +2.13999949401839e01,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                        +3.10444218682464e00,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "MB16_43_01": Refs(
        {
            "cn": torch.tensor(
                [
                    +4.15066368951397e00,
                    +9.78868026389781e-01,
                    +2.01080985633859e00,
                    +1.47865697827818e00,
                    +1.03577822442117e00,
                    +1.01206994314781e00,
                    +1.50329777127401e00,
                    +1.99858468272609e00,
                    +3.89181927539324e00,
                    +1.04323373360740e00,
                    +1.01526584450636e00,
                    +1.99315213227354e00,
                    +4.63526560889683e00,
                    +3.87312260639335e00,
                    +3.99316800677884e00,
                    +5.45068226903888e0,
                ],
                dtype=torch.double,
            ),
            "weights": torch.tensor(
                [
                    [
                        +4.61254014807976e-13,
                        +9.99999999999539e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.78431945472983e-01,
                        +2.15680545270172e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.33252077840319e-08,
                        +1.55830681937747e-02,
                        +9.84416838481017e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.99424904108747e-01,
                        +5.75095891252906e-04,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +1.35771400228363e-02,
                        +9.86422859977164e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.82992148346892e-01,
                        +1.70078516531077e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.99519469064248e-01,
                        +4.80530935751615e-04,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +1.13181694792597e-07,
                        +1.71503960869602e-02,
                        +9.82849490731345e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +1.25926325849160e-25,
                        +6.73263145629432e-14,
                        +1.94165275506323e-05,
                        +9.99980583472382e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.86403420777318e-01,
                        +1.35965792226822e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.83377538259043e-01,
                        +1.66224617409573e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +6.63636803493899e-06,
                        +9.99993363631965e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +4.78432084484299e-38,
                        +4.72470789879862e-24,
                        +2.64845507076682e-13,
                        +7.08386079833514e-06,
                        +9.99992916138937e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +5.57929648633356e-26,
                        +1.48261370770972e-14,
                        +2.19715394953033e-06,
                        +1.59978977357256e-01,
                        +8.40018825488779e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +1.11473605172390e-26,
                        +1.33471958830444e-14,
                        +8.80046323582265e-06,
                        +9.99991199536751e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +3.64404060381414e-41,
                        +1.64269207706493e-24,
                        +4.50618875164815e-11,
                        +9.99999999954938e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
            "c6": torch.tensor(
                [
                    [
                        +1.86105200000295e02,
                        +2.10637967443952e01,
                        +3.33393205851663e01,
                        +2.07648885028596e01,
                        +2.50462879811640e01,
                        +2.09988662957750e01,
                        +2.07635420397407e01,
                        +3.33469365793004e01,
                        +4.44925237765056e01,
                        +2.09502948932743e01,
                        +2.09933789215108e01,
                        +1.11982907430142e02,
                        +6.38123316167329e01,
                        +6.45263838745924e01,
                        +4.44924561012183e01,
                        +1.60659400002538e02,
                    ],
                    [
                        +2.10637967443952e01,
                        +3.10104597907844e00,
                        +5.44104128537895e00,
                        +3.06460553022247e00,
                        +4.32334790530218e00,
                        +3.09313018967101e00,
                        +3.06444138044805e00,
                        +5.44213006593611e00,
                        +6.85278222181144e00,
                        +3.08720876141063e00,
                        +3.09246121386693e00,
                        +1.67260314058114e01,
                        +9.32232615546217e00,
                        +9.40964391592266e00,
                        +6.85277268893649e00,
                        +2.13390348985262e01,
                    ],
                    [
                        +3.33393205851663e01,
                        +5.44104128537895e00,
                        +1.04060662211154e01,
                        +5.38395096621487e00,
                        +8.57335406068136e00,
                        +5.42863982058108e00,
                        +5.38369379696184e00,
                        +1.04078420241680e01,
                        +1.26306609797298e01,
                        +5.41936287038137e00,
                        +5.42759175329962e00,
                        +2.97398273677055e01,
                        +1.63311877211176e01,
                        +1.64664919883409e01,
                        +1.26306453073937e01,
                        +3.55362026390315e01,
                    ],
                    [
                        +2.07648885028596e01,
                        +3.06460553022247e00,
                        +5.38395096621487e00,
                        +3.02866858604329e00,
                        +4.28051674110831e00,
                        +3.05679911479676e00,
                        +3.02850670435781e00,
                        +5.38502623652600e00,
                        +6.77670142181813e00,
                        +3.05095950404731e00,
                        +3.05613938235978e00,
                        +1.65326001720343e01,
                        +9.21222013302869e00,
                        +9.29832544621136e00,
                        +6.77669200846439e00,
                        +2.10658829179373e01,
                    ],
                    [
                        +2.50462879811640e01,
                        +4.32334790530218e00,
                        +8.57335406068136e00,
                        +4.28051674110831e00,
                        +7.16510167612946e00,
                        +4.31404389049233e00,
                        +4.28032380369504e00,
                        +8.57471450429471e00,
                        +1.02476219308165e01,
                        +4.30708399636246e00,
                        +4.31325759357762e00,
                        +2.37716272051766e01,
                        +1.29661524144552e01,
                        +1.30671606537876e01,
                        +1.02476098345869e01,
                        +2.75317129235774e01,
                    ],
                    [
                        +2.09988662957750e01,
                        +3.09313018967101e00,
                        +5.42863982058108e00,
                        +3.05679911479676e00,
                        +4.31404389049233e00,
                        +3.08523815906549e00,
                        +3.05663545770877e00,
                        +5.42972566637027e00,
                        +6.83625554309033e00,
                        +3.07933450364290e00,
                        +3.08457119115511e00,
                        +1.66840132375542e01,
                        +9.29840833574711e00,
                        +9.38546272191831e00,
                        +6.83624603617842e00,
                        +2.12796993628112e01,
                    ],
                    [
                        +2.07635420397407e01,
                        +3.06444138044805e00,
                        +5.38369379696184e00,
                        +3.02850670435781e00,
                        +4.28032380369504e00,
                        +3.05663545770877e00,
                        +3.02834483288917e00,
                        +5.38476900641466e00,
                        +6.77635870797818e00,
                        +3.05079621551476e00,
                        +3.05597576690949e00,
                        +1.65317288410165e01,
                        +9.21172414905175e00,
                        +9.29782400064014e00,
                        +6.77634929516284e00,
                        +2.10646524765623e01,
                    ],
                    [
                        +3.33469365793004e01,
                        +5.44213006593611e00,
                        +1.04078420241680e01,
                        +5.38502623652600e00,
                        +8.57471450429471e00,
                        +5.42972566637027e00,
                        +5.38476900641466e00,
                        +1.04096182819417e01,
                        +1.26329675237980e01,
                        +5.42044652080921e00,
                        +5.42867735106695e00,
                        +2.97456233348293e01,
                        +1.63344547422583e01,
                        +1.64697916829337e01,
                        +1.26329518479543e01,
                        +3.55438470017986e01,
                    ],
                    [
                        +4.44925237765056e01,
                        +6.85278222181144e00,
                        +1.26306609797298e01,
                        +6.77670142181813e00,
                        +1.02476219308165e01,
                        +6.83625554309033e00,
                        +6.77635870797818e00,
                        +1.26329675237980e01,
                        +1.55817742139549e01,
                        +6.82389271515335e00,
                        +6.83485884749660e00,
                        +3.72381957696309e01,
                        +2.05886604700550e01,
                        +2.07697483350778e01,
                        +1.55817539255380e01,
                        +4.59400237556194e01,
                    ],
                    [
                        +2.09502948932743e01,
                        +3.08720876141063e00,
                        +5.41936287038137e00,
                        +3.05095950404731e00,
                        +4.30708399636246e00,
                        +3.07933450364290e00,
                        +3.05079621551476e00,
                        +5.42044652080921e00,
                        +6.82389271515335e00,
                        +3.07344414324100e00,
                        +3.07866903774297e00,
                        +1.66525814300412e01,
                        +9.28051654425321e00,
                        +9.36737391255552e00,
                        +6.82388322766317e00,
                        +2.12353132504549e01,
                    ],
                    [
                        +2.09933789215108e01,
                        +3.09246121386693e00,
                        +5.42759175329962e00,
                        +3.05613938235978e00,
                        +4.31325759357762e00,
                        +3.08457119115511e00,
                        +3.05597576690949e00,
                        +5.42867735106695e00,
                        +6.83485884749660e00,
                        +3.07866903774297e00,
                        +3.08390439293497e00,
                        +1.66804622161148e01,
                        +9.29638700321132e00,
                        +9.38341913120739e00,
                        +6.83484934277887e00,
                        +2.12746848234302e01,
                    ],
                    [
                        +1.11982907430142e02,
                        +1.67260314058114e01,
                        +2.97398273677055e01,
                        +1.65326001720343e01,
                        +2.37716272051766e01,
                        +1.66840132375542e01,
                        +1.65317288410165e01,
                        +2.97456233348293e01,
                        +3.72381957696309e01,
                        +1.66525814300412e01,
                        +1.66804622161148e01,
                        +9.03985128506635e01,
                        +5.02708240732723e01,
                        +5.07336615572416e01,
                        +3.72381448273806e01,
                        +1.14240508062473e02,
                    ],
                    [
                        +6.38123316167329e01,
                        +9.32232615546217e00,
                        +1.63311877211176e01,
                        +9.21222013302869e00,
                        +1.29661524144552e01,
                        +9.29840833574711e00,
                        +9.21172414905175e00,
                        +1.63344547422583e01,
                        +2.05886604700550e01,
                        +9.28051654425321e00,
                        +9.29638700321132e00,
                        +5.02708240732723e01,
                        +2.80315233611672e01,
                        +2.82953233553807e01,
                        +2.05886317918059e01,
                        +6.43332290431569e01,
                    ],
                    [
                        +6.45263838745924e01,
                        +9.40964391592266e00,
                        +1.64664919883409e01,
                        +9.29832544621136e00,
                        +1.30671606537876e01,
                        +9.38546272191831e00,
                        +9.29782400064014e00,
                        +1.64697916829337e01,
                        +2.07697483350778e01,
                        +9.36737391255552e00,
                        +9.38341913120739e00,
                        +5.07336615572416e01,
                        +2.82953233553807e01,
                        +2.85620489152008e01,
                        +2.07697193680983e01,
                        +6.49891385224176e01,
                    ],
                    [
                        +4.44924561012183e01,
                        +6.85277268893649e00,
                        +1.26306453073937e01,
                        +6.77669200846439e00,
                        +1.02476098345869e01,
                        +6.83624603617842e00,
                        +6.77634929516284e00,
                        +1.26329518479543e01,
                        +1.55817539255380e01,
                        +6.82388322766317e00,
                        +6.83484934277887e00,
                        +3.72381448273806e01,
                        +2.05886317918059e01,
                        +2.07697193680983e01,
                        +1.55817336371518e01,
                        +4.59399560920098e01,
                    ],
                    [
                        +1.60659400002538e02,
                        +2.13390348985262e01,
                        +3.55362026390315e01,
                        +2.10658829179373e01,
                        +2.75317129235774e01,
                        +2.12796993628112e01,
                        +2.10646524765623e01,
                        +3.55438470017986e01,
                        +4.59400237556194e01,
                        +2.12353132504549e01,
                        +2.12746848234302e01,
                        +1.14240508062473e02,
                        +6.43332290431569e01,
                        +6.49891385224176e01,
                        +4.59399560920098e01,
                        +1.53594500003907e02,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "PbH4-BiH3": Refs(
        {
            "cn": torch.tensor(
                [
                    +3.93882078385452e00,
                    +9.83202447815541e-01,
                    +9.83202575698739e-01,
                    +9.83202575698739e-01,
                    +9.86589814809524e-01,
                    +2.97146042634822e00,
                    +9.87045550753296e-01,
                    +9.87045669088046e-01,
                    +9.87045550753296e-01,
                ],
                dtype=torch.double,
            ),
            "weights": torch.tensor(
                [
                    [
                        +1.10706478210448e-27,
                        +2.26599265549586e-16,
                        +1.05725184914546e-07,
                        +1.41167956987467e-02,
                        +9.85883098576068e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79089158960743e-01,
                        +2.09108410392566e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79089178059127e-01,
                        +2.09108219408730e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79089178059127e-01,
                        +2.09108219408730e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79589093181984e-01,
                        +2.04109068180158e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +4.51567208622703e-16,
                        +1.31099357580350e-07,
                        +1.71917663233654e-02,
                        +9.82808102577277e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79655454782451e-01,
                        +2.03445452175495e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79655471986197e-01,
                        +2.03445280138028e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.79655454782451e-01,
                        +2.03445452175495e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
            "c6": torch.tensor(
                [
                    [
                        +4.56209027097378e02,
                        +3.72742207576559e01,
                        +3.72742203407386e01,
                        +3.72742203407386e01,
                        +3.72633072045004e01,
                        +4.93665090064696e02,
                        +3.72618585322083e01,
                        +3.72618581566509e01,
                        +3.72618585322083e01,
                    ],
                    [
                        +3.72742207576559e01,
                        +3.09876483566212e00,
                        +3.09876480252469e00,
                        +3.09876480252469e00,
                        +3.09789740447628e00,
                        +4.02583668373402e01,
                        +3.09778226108473e00,
                        +3.09778223123467e00,
                        +3.09778226108473e00,
                    ],
                    [
                        +3.72742203407386e01,
                        +3.09876480252469e00,
                        +3.09876476938727e00,
                        +3.09876476938727e00,
                        +3.09789737134977e00,
                        +4.02583663834069e01,
                        +3.09778222795966e00,
                        +3.09778219810960e00,
                        +3.09778222795966e00,
                    ],
                    [
                        +3.72742203407386e01,
                        +3.09876480252469e00,
                        +3.09876476938727e00,
                        +3.09876476938727e00,
                        +3.09789737134977e00,
                        +4.02583663834069e01,
                        +3.09778222795966e00,
                        +3.09778219810960e00,
                        +3.09778222795966e00,
                    ],
                    [
                        +3.72633072045004e01,
                        +3.09789740447628e00,
                        +3.09789737134977e00,
                        +3.09789737134977e00,
                        +3.09703025884030e00,
                        +4.02464843239764e01,
                        +3.09691515335283e00,
                        +3.09691512351259e00,
                        +3.09691515335283e00,
                    ],
                    [
                        +4.93665090064696e02,
                        +4.02583668373402e01,
                        +4.02583663834069e01,
                        +4.02583663834069e01,
                        +4.02464843239764e01,
                        +5.34419964675118e02,
                        +4.02449070312629e01,
                        +4.02449066223616e01,
                        +4.02449070312629e01,
                    ],
                    [
                        +3.72618585322083e01,
                        +3.09778226108473e00,
                        +3.09778222795966e00,
                        +3.09778222795966e00,
                        +3.09691515335283e00,
                        +4.02449070312629e01,
                        +3.09680005289677e00,
                        +3.09680002305784e00,
                        +3.09680005289677e00,
                    ],
                    [
                        +3.72618581566509e01,
                        +3.09778223123467e00,
                        +3.09778219810960e00,
                        +3.09778219810960e00,
                        +3.09691512351259e00,
                        +4.02449066223616e01,
                        +3.09680002305784e00,
                        +3.09679999321891e00,
                        +3.09680002305784e00,
                    ],
                    [
                        +3.72618585322083e01,
                        +3.09778226108473e00,
                        +3.09778222795966e00,
                        +3.09778222795966e00,
                        +3.09691515335283e00,
                        +4.02449070312629e01,
                        +3.09680005289677e00,
                        +3.09680002305784e00,
                        +3.09680005289677e00,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "C6H5I-CH3SH": Refs(
        {
            "cn": torch.tensor(
                [
                    +3.13936895934395e00,
                    +3.13131666863102e00,
                    +3.13937683960227e00,
                    +3.31534291514346e00,
                    +3.13765455567338e00,
                    +3.31481155018318e00,
                    +1.53636056287591e00,
                    +1.00352466398219e00,
                    +1.01223354855399e00,
                    +1.00366192372190e00,
                    +1.01219594356898e00,
                    +1.00366200689047e00,
                    +2.15705640674763e00,
                    +9.98181081558970e-01,
                    +3.98411287017616e00,
                    +1.01462256394391e00,
                    +1.01235611510819e00,
                    +1.00858912903507e00,
                ],
                dtype=torch.double,
            ),
            "weights": torch.tensor(
                [
                    [
                        +7.66915348045866e-18,
                        +9.04559372001613e-09,
                        +5.55474084124553e-03,
                        +9.36199574012947e-01,
                        +5.82456761002137e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.33337260445326e-18,
                        +1.03304923176417e-08,
                        +5.94352226939526e-03,
                        +9.39218013018462e-01,
                        +5.48384543816506e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +7.66767874029992e-18,
                        +9.04441693210364e-09,
                        +5.55437244105958e-03,
                        +9.36196513315798e-01,
                        +5.82491051987251e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.61278067966140e-20,
                        +4.54846017777575e-10,
                        +1.16048785372819e-03,
                        +7.99583198542082e-01,
                        +1.99256313149343e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +7.99678634625602e-18,
                        +9.30523441007744e-09,
                        +5.63544094450366e-03,
                        +9.36860440392255e-01,
                        +5.75041093580066e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.74417166809199e-20,
                        +4.59132999088564e-10,
                        +1.16639851843437e-03,
                        +8.00245977284164e-01,
                        +1.98587623738269e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +2.54205655667171e-04,
                        +9.99745794344333e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.81918044661934e-01,
                        +1.80819553380659e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.83012088864378e-01,
                        +1.69879111356215e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.81935812878635e-01,
                        +1.80641871213652e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.83007507536486e-01,
                        +1.69924924635144e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.81935823639575e-01,
                        +1.80641763604250e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.18809691426923e-09,
                        +5.00585297181196e-03,
                        +9.94994137840091e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.81212828585247e-01,
                        +1.87871714147530e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +2.61014227249546e-28,
                        +2.42411690886486e-16,
                        +1.38694757870492e-07,
                        +2.01508154369845e-02,
                        +9.79849045868257e-01,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.83300662218751e-01,
                        +1.66993377812491e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.83027012438879e-01,
                        +1.69729875611206e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                    [
                        +9.82562408977771e-01,
                        +1.74375910222289e-02,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                        +0.00000000000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
            "c6": torch.tensor(
                [
                    [
                        +2.53086694842437e01,
                        +2.53236159084896e01,
                        +2.53086544809279e01,
                        +2.47100760277660e01,
                        +2.53119158180357e01,
                        +2.47128891340438e01,
                        +9.48922900325656e01,
                        +8.82857683343213e00,
                        +8.82319289903895e00,
                        +8.82848939371737e00,
                        +8.82321544435180e00,
                        +8.82848934076138e00,
                        +5.62455312853600e01,
                        +8.83204729384078e00,
                        +2.14360070777824e01,
                        +8.82177279187685e00,
                        +8.82311945817995e00,
                        +8.82540583248536e00,
                    ],
                    [
                        +2.53236159084896e01,
                        +2.53385737670487e01,
                        +2.53236008936914e01,
                        +2.47245622275532e01,
                        +2.53268647265581e01,
                        +2.47273774996866e01,
                        +9.49508531711154e01,
                        +8.83383171969513e00,
                        +8.82844384885730e00,
                        +8.83374421604913e00,
                        +8.82846641065407e00,
                        +8.83374416305442e00,
                        +5.62800562259229e01,
                        +8.83730471751867e00,
                        +2.14479713482813e01,
                        +8.82702270338885e00,
                        +8.82837035430227e00,
                        +8.83065840028219e00,
                    ],
                    [
                        +2.53086544809279e01,
                        +2.53236008936914e01,
                        +2.53086394776235e01,
                        +2.47100614866121e01,
                        +2.53119008122251e01,
                        +2.47128745907148e01,
                        +9.48922312429173e01,
                        +8.82857155866703e00,
                        +8.82318762822647e00,
                        +8.82848411901647e00,
                        +8.82321017352276e00,
                        +8.82848406606051e00,
                        +5.62454966276673e01,
                        +8.83204201652784e00,
                        +2.14359950691858e01,
                        +8.82176752210693e00,
                        +8.82311418742137e00,
                        +8.82540056004824e00,
                    ],
                    [
                        +2.47100760277660e01,
                        +2.47245622275532e01,
                        +2.47100614866121e01,
                        +2.41300091503453e01,
                        +2.47132223699295e01,
                        +2.41327350652656e01,
                        +9.25450400227954e01,
                        +8.61818543474823e00,
                        +8.61295975815401e00,
                        +8.61810056527593e00,
                        +8.61298164075975e00,
                        +8.61810051387655e00,
                        +5.48621486974196e01,
                        +8.62155388287635e00,
                        +2.09574675249769e01,
                        +8.61158139426314e00,
                        +8.61288847604877e00,
                        +8.61510764363531e00,
                    ],
                    [
                        +2.53119158180357e01,
                        +2.53268647265581e01,
                        +2.53119008122251e01,
                        +2.47132223699295e01,
                        +2.53151626915744e01,
                        +2.47160359467776e01,
                        +9.49050104461900e01,
                        +8.82971816324588e00,
                        +8.82433337366177e00,
                        +8.82963070964208e00,
                        +8.82435592255574e00,
                        +8.82963065667768e00,
                        +5.62530302631426e01,
                        +8.83318917490684e00,
                        +2.14386054857927e01,
                        +8.82291304092804e00,
                        +8.82425992113731e00,
                        +8.82654665861330e00,
                    ],
                    [
                        +2.47128891340438e01,
                        +2.47273774996866e01,
                        +2.47128745907148e01,
                        +2.41327350652656e01,
                        +2.47160359467776e01,
                        +2.41354613905380e01,
                        +9.25560734133844e01,
                        +8.61917409179224e00,
                        +8.61394767066187e00,
                        +8.61908921022803e00,
                        +8.61396955638537e00,
                        +8.61908915882133e00,
                        +5.48686508434178e01,
                        +8.62254301984509e00,
                        +2.09597156158777e01,
                        +8.61256911038653e00,
                        +8.61387637840061e00,
                        +8.61609586216640e00,
                    ],
                    [
                        +9.48922900325656e01,
                        +9.49508531711154e01,
                        +9.48922312429173e01,
                        +9.25450400227954e01,
                        +9.49050104461900e01,
                        +9.25560734133844e01,
                        +3.58497831396092e02,
                        +3.31610125661753e01,
                        +3.31400786291125e01,
                        +3.31606725810729e01,
                        +3.31401662903144e01,
                        +3.31606723751682e01,
                        +2.12283949836107e02,
                        +3.31745064898504e01,
                        +7.97027494030697e01,
                        +3.31345569359076e01,
                        +3.31397930746818e01,
                        +3.31486830076409e01,
                    ],
                    [
                        +8.82857683343213e00,
                        +8.83383171969513e00,
                        +8.82857155866703e00,
                        +8.61818543474823e00,
                        +8.82971816324588e00,
                        +8.61917409179224e00,
                        +3.31610125661753e01,
                        +3.08895723244586e00,
                        +3.08706250254790e00,
                        +3.08892646040635e00,
                        +3.08707043676017e00,
                        +3.08892644176992e00,
                        +1.96792520574283e01,
                        +3.09017856699708e00,
                        +7.46755679047458e00,
                        +3.08656273429260e00,
                        +3.08703665702655e00,
                        +3.08784128454205e00,
                    ],
                    [
                        +8.82319289903895e00,
                        +8.82844384885730e00,
                        +8.82318762822647e00,
                        +8.61295975815401e00,
                        +8.82433337366177e00,
                        +8.61394767066187e00,
                        +3.31400786291125e01,
                        +3.08706250254790e00,
                        +3.08516914014558e00,
                        +3.08703175271770e00,
                        +3.08517706863144e00,
                        +3.08703173409473e00,
                        +1.96668860512657e01,
                        +3.08828295561747e00,
                        +7.46319796171210e00,
                        +3.08466973259124e00,
                        +3.08514331327788e00,
                        +3.08594736006437e00,
                    ],
                    [
                        +8.82848939371737e00,
                        +8.83374421604913e00,
                        +8.82848411901647e00,
                        +8.61810056527593e00,
                        +8.82963070964208e00,
                        +8.61908921022803e00,
                        +3.31606725810729e01,
                        +3.08892646040635e00,
                        +3.08703175271770e00,
                        +3.08889568872755e00,
                        +3.08703968683697e00,
                        +3.08889567009134e00,
                        +1.96790512228764e01,
                        +3.09014778064156e00,
                        +7.46748599935495e00,
                        +3.08653199032049e00,
                        +3.08700590749930e00,
                        +3.08781052558326e00,
                    ],
                    [
                        +8.82321544435180e00,
                        +8.82846641065407e00,
                        +8.82321017352276e00,
                        +8.61298164075975e00,
                        +8.82435592255574e00,
                        +8.61396955638537e00,
                        +3.31401662903144e01,
                        +3.08707043676017e00,
                        +3.08517706863144e00,
                        +3.08703968683697e00,
                        +3.08518499714127e00,
                        +3.08703966821393e00,
                        +1.96669378341176e01,
                        +3.08829089352095e00,
                        +7.46321621437845e00,
                        +3.08467765956666e00,
                        +3.08515124168563e00,
                        +3.08595529090393e00,
                    ],
                    [
                        +8.82848934076138e00,
                        +8.83374416305442e00,
                        +8.82848406606051e00,
                        +8.61810051387655e00,
                        +8.82963065667768e00,
                        +8.61908915882133e00,
                        +3.31606723751682e01,
                        +3.08892644176992e00,
                        +3.08703173409473e00,
                        +3.08889567009134e00,
                        +3.08703966821393e00,
                        +3.08889565145513e00,
                        +1.96790511012452e01,
                        +3.09014776199646e00,
                        +7.46748595648182e00,
                        +3.08653197170106e00,
                        +3.08700588887651e00,
                        +3.08781050695476e00,
                    ],
                    [
                        +5.62455312853600e01,
                        +5.62800562259229e01,
                        +5.62454966276673e01,
                        +5.48621486974196e01,
                        +5.62530302631426e01,
                        +5.48686508434178e01,
                        +2.12283949836107e02,
                        +1.96792520574283e01,
                        +1.96668860512657e01,
                        +1.96790512228764e01,
                        +1.96669378341176e01,
                        +1.96790511012452e01,
                        +1.25836586473867e02,
                        +1.96872231305630e01,
                        +4.72941948267372e01,
                        +1.96636243001677e01,
                        +1.96667173697683e01,
                        +1.96719687931115e01,
                    ],
                    [
                        +8.83204729384078e00,
                        +8.83730471751867e00,
                        +8.83204201652784e00,
                        +8.62155388287635e00,
                        +8.83318917490684e00,
                        +8.62254301984509e00,
                        +3.31745064898504e01,
                        +3.09017856699708e00,
                        +3.08828295561747e00,
                        +3.09014778064156e00,
                        +3.08829089352095e00,
                        +3.09014776199646e00,
                        +1.96872231305630e01,
                        +3.09140046974751e00,
                        +7.47036647230640e00,
                        +3.08778295485591e00,
                        +3.08825709807205e00,
                        +3.08906209992291e00,
                    ],
                    [
                        +2.14360070777824e01,
                        +2.14479713482813e01,
                        +2.14359950691858e01,
                        +2.09574675249769e01,
                        +2.14386054857927e01,
                        +2.09597156158777e01,
                        +7.97027494030697e01,
                        +7.46755679047458e00,
                        +7.46319796171210e00,
                        +7.46748599935495e00,
                        +7.46321621437845e00,
                        +7.46748595648182e00,
                        +4.72941948267372e01,
                        +7.47036647230640e00,
                        +1.83413164591959e01,
                        +7.46204824414648e00,
                        +7.46313850405433e00,
                        +7.46498955077155e00,
                    ],
                    [
                        +8.82177279187685e00,
                        +8.82702270338885e00,
                        +8.82176752210693e00,
                        +8.61158139426314e00,
                        +8.82291304092804e00,
                        +8.61256911038653e00,
                        +3.31345569359076e01,
                        +3.08656273429260e00,
                        +3.08466973259124e00,
                        +3.08653199032049e00,
                        +3.08467765956666e00,
                        +3.08653197170106e00,
                        +1.96636243001677e01,
                        +3.08778295485591e00,
                        +7.46204824414648e00,
                        +3.08417042017811e00,
                        +3.08464391064378e00,
                        +3.08544780425280e00,
                    ],
                    [
                        +8.82311945817995e00,
                        +8.82837035430227e00,
                        +8.82311418742137e00,
                        +8.61288847604877e00,
                        +8.82425992113731e00,
                        +8.61387637840061e00,
                        +3.31397930746818e01,
                        +3.08703665702655e00,
                        +3.08514331327788e00,
                        +3.08700590749930e00,
                        +3.08515124168563e00,
                        +3.08700588887651e00,
                        +1.96667173697683e01,
                        +3.08825709807205e00,
                        +7.46313850405433e00,
                        +3.08464391064378e00,
                        +3.08511748666464e00,
                        +3.08592152552955e00,
                    ],
                    [
                        +8.82540583248536e00,
                        +8.83065840028219e00,
                        +8.82540056004824e00,
                        +8.61510764363531e00,
                        +8.82654665861330e00,
                        +8.61609586216640e00,
                        +3.31486830076409e01,
                        +3.08784128454205e00,
                        +3.08594736006437e00,
                        +3.08781052558326e00,
                        +3.08595529090393e00,
                        +3.08781050695476e00,
                        +1.96719687931115e01,
                        +3.08906209992291e00,
                        +7.46498955077155e00,
                        +3.08544780425280e00,
                        +3.08592152552955e00,
                        +3.08672581101038e00,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "AmF3": Refs(
        {
            "cn": torch.tensor(
                [
                    +2.99072690000000e00,
                    +0.99768090000000e00,
                    +0.99767850000000e00,
                    +0.99768040000000e00,
                ],
                dtype=torch.double,
            ),
            "weights": torch.tensor(
                [
                    [
                        +3.01777620000000e-16,
                        +3.48560790000000e-08,
                        +6.05574020000000e-03,
                        +9.93942080000000e-01,
                        +2.12835020000000e-06,
                        +3.22313320000000e-14,
                        +0.00000000000000e00,
                    ],
                    [
                        +0.01831650000000e00,
                        0.981683500000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                    ],
                    [
                        0.018316800000000e00,
                        0.981683200000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                    ],
                    [
                        0.018316600000000e00,
                        0.981683400000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                        0.000000000000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
            "c6": torch.tensor(
                [
                    [
                        +524.180114700000e00,
                        +54.4235535000000e00,
                        +54.4235573000000e00,
                        +54.4235573000000e00,
                    ],
                    [
                        +54.4235535000000e00,
                        +7.17594720000000e00,
                        +7.17594770000000e00,
                        +7.17594770000000e00,
                    ],
                    [
                        +54.4235535000000e00,
                        +7.17594770000000e00,
                        +7.17594860000000e00,
                        +7.17594810000000e00,
                    ],
                    [
                        +54.4235535000000e00,
                        +7.17594770000000e00,
                        +7.17594810000000e00,
                        +7.17594810000000e00,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
}

samples: Dict[str, Record] = merge_nested_dicts(mols, refs)
